install.packages("DescTools")
library(DescTools)

#a) 

#a -  Eine Funktion, die verschiedene geeignete deskriptive Statistiken fuer 
#     metrische Variablen berechnet und ausgibt.
#
#Input: x - ein Vektor, der qualitative Merkmale enth√§lt, die auf einer 
#           metrischen Skala basieren
#
#Output: eine benannte Liste mit folgenden deskriptiven Statistiken:
#       - arithmetisches Mittel
#       - 10% getrimmtes Mittel
#       - Median
#       - Varianz
#       - Standardabweichung
#       - Minimum
#       - Maximum
#       - Spannweite
#       - Quantile 


a <- function(x)
{
  am <- mean(x)
  gm <- mean(x,trim = 0.1)
  med <- median(x)
  va <- var(x)
  sa <- sd(x)
  quantil <- quantile(x, c(0.25,0.5,0.75))
  mi <- min(x)
  ma <- max(x)
  sp <- ma - mi
  n <- length(x)
  mqa <- sum((x - am)^2) / n
  
  
  return(list("arithmetisches Mittel" = am,
              "10% getrimmtes Mittel" = gm,
              "Median" = med,
              "Varianz" = va,
              "Standardabweichung" = sa,
              "Minimum" = mi,
              "Maximum" = ma,
              "Spannweite" = sp,
              "Quantile" = quantil,
              "Variationskoeffizient" = (sqrt(mqa)/am)))
}


#b) 

#b -  Eine Funktion, die verschiedene geeignete deskriptive Statistiken
#     f√ºr kategoriale Variablen berechnet und ausgibt
#
#Input: x - ein Vektor, der kategoriel skalierte Merkmale enth√§lt
#
#Output: : eine Liste welche die Gesamtanzahl der Elemente und den Modus angibt

#Hilfsfuntion die in Funktion-R-Skript-2 ausgelagert werden kann
modus <- function(x){
  for(i in 1:length(table(x))){
    if(table(x)[i] == max(table(x))){
      return(table(x)[i])
    }
  }
}

b<-function(x){
  return(list( Anzahl = length(x), "Modus" = modus(x) ))
}


#c)

#c - Eine Funktion, die geeignete deskriptive bivariate Statistiken fuer
#den Zusammenhang zwischen zwei kategorialen Variablen
#berechnet ausgibt
#
#
#Input: x,y,z: x = Kategorialer Vektor, y = Kategorialer Vektor, z = Wert von 0 oder 1
#
#
#Output: z = 0: Gibt verschiedene Koeffizienten f¸r x und y an.
#        z = 1: Gibt den Chi^2 Test f¸r x und y an.
#
# 


c <- function(x,y,z)
{
  if(z == 0){
  return(Assocs(table(x,y)))
  }
  if(z == 1)
  return(chisq.test(x,y))
}
